(this["webpackJsonpmephisto-web"]=this["webpackJsonpmephisto-web"]||[]).push([[0],{101:function(e,t,a){e.exports=a(159)},106:function(e,t,a){},107:function(e,t,a){},159:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(12),c=a.n(l),o=(a(106),a(107),a(14)),i=a(163),s=a(17),u=function(e){var t=e.children,a=e.heading,n=e.badge;return r.a.createElement(i.b,{elevation:s.a.THREE,className:"widget"},r.a.createElement("h4",{className:"bp3-heading",style:{marginBottom:15}},void 0!==n&&r.a.createElement("span",{className:"bp3-tag bp3-large bp3-minimal bp3-round step-badge"},n),a),t)},m=a(55);var d=a(3),p=a.n(d),E=a(16),f=a(9),g=a(1),b=a(20),v=a(156);function h(){return k}var k=function(e){var t,a=e.info,n=e.onLoading,r=e.onError,l=e.onData,c=e.onEmptyData,i=e.checkIfEmptyFn,s=Object(o.a)(a,2),u=s[0],m=u.data,d=u.loading,p=u.error,E=s[1],f={refetch:void 0===E?function(){}:E,axiosInfo:a};if(d)return n(Object(b.a)({},f));if(p)return r(Object(b.a)({error:null===(t=p.response)||void 0===t?void 0:t.data},f));var g=void 0!==i?i(m):m;return v(g)&&void 0!==c?c(Object(b.a)({data:m},f)):l(Object(b.a)({data:m},f))};var y=h(),N=function(){var e,t,a=r.a.useState(0),n=Object(o.a)(a,2),l=(n[0],n[1],r.a.useState(1)),c=Object(o.a)(l,2),s=c[0],d=(c[1],r.a.useState(!1)),b=Object(o.a)(d,2),v=b[0],h=b[1],k=Object(E.b)({url:"requesters"});return r.a.createElement(u,{badge:"Step 1",heading:r.a.createElement("span",null,"Prepare it")},r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"bullet"},r.a.createElement("div",{className:"bp3-text-large bp3-running-text bp3-text-muted"},r.a.createElement(y,{info:k,onError:function(e){var t=e.refetch;return r.a.createElement("span",null,r.a.createElement(i.f,{icon:"warning-sign",color:m.a.RED3})," Something went wrong."," ",r.a.createElement("a",{onClick:function(){return t()}},r.a.createElement("strong",null,"Try again")))},onLoading:function(){return r.a.createElement("div",{className:"bp3-skeleton bp3-text"},"\xa0 ")},checkIfEmptyFn:function(e){return e.requesters},onEmptyData:function(){return r.a.createElement("span",null,r.a.createElement(i.f,{icon:"warning-sign",color:m.a.ORANGE3}),"  ","You have no accounts set up."," ",r.a.createElement("a",null,r.a.createElement("strong",null,"Configure")))},onData:function(e){var t=e.data;return r.a.createElement("span",null,r.a.createElement(i.f,{icon:"people"})," You have"," ",r.a.createElement("a",{onClick:function(){return h(!0)}},r.a.createElement("strong",null,t.requesters.length," requester accounts"))," ","set up")}})),r.a.createElement(i.d,{icon:"people",onClose:function(){return h(!1)},title:"Requester accounts",autoFocus:!0,canEscapeKeyClose:!0,enforceFocus:!0,hasBackdrop:!0,isOpen:v,position:f.a.BOTTOM,size:"72%",usePortal:!0},r.a.createElement("div",{className:g.a.DRAWER_BODY,style:{backgroundColor:m.a.LIGHT_GRAY4}},r.a.createElement("div",{className:g.a.DIALOG_BODY},k[0].data&&r.a.createElement("div",null,k[0].data.requesters.map((function(e){return r.a.createElement("div",{key:e.requester_id,style:{marginBottom:12}},r.a.createElement(i.b,{interactive:!0},r.a.createElement(i.f,{icon:e.registered?"tick-circle":"issue",color:e.registered?m.a.GREEN4:m.a.GRAY4,title:"Registered?"}),r.a.createElement("span",{style:{margin:"0 15px"},className:"bp3-tag bp3-large bp3-minimal bp3-round step-badge"},e.provider_type),r.a.createElement("h4",{style:{display:"inline",marginRight:4},className:p()("bp3-heading",{"bp3-text-muted":!e.registered})},e.requester_name)," ",!e.registered&&r.a.createElement("span",null,"\u2014 This account still needs to be registered.")))})),r.a.createElement("div",{style:{marginTop:15}},r.a.createElement(i.a,{disabled:!0,icon:"new-person"},"[TODO] Add a new requester account..."))))))),r.a.createElement("div",{className:"bullet"},r.a.createElement("div",{className:"bp3-text-large bp3-running-text bp3-text-muted"},r.a.createElement(i.f,{icon:1===s?"layer":"layers"})," You have"," ",r.a.createElement("strong",null,s," task"," ",(e="template",1===s?e:t||e+"s")),"  ","available to use"))))},O={live_task_count:1,task_count:1,task_runs:[{param_string:"--test --task --run --test --task --run --test --task --run --test --task --run --test --task --run --test --task --run --test --task --run --test --task --run --test --task --run ",params:{"run params":"Coming soon!",status:"Not yet implemented"},sandbox:!1,start_time:"2019-12-09 22:53:30",task_id:"1",task_name:"test_task",task_run_id:"1",task_status:{accepted:0,assigned:0,completed:0,created:3,expired:0,launched:0,mixed:0,rejected:0},task_type:"mock"}]},_=a(18),C=a(61),x=a.n(C);function R(e){var t=e.run;return r.a.createElement("div",{className:"run-header",style:{backgroundColor:m.a.LIGHT_GRAY5,padding:10,marginBottom:"10px",borderColor:m.a.GRAY5,borderWidth:1,borderStyle:"solid",borderRadius:5}},r.a.createElement("h5",{className:"bp3-heading",style:{display:"inline"}},t.task_name)," ","\u2014 ",x()(t.start_time).fromNow(),r.a.createElement(i.k,{icon:"play",intent:_.a.SUCCESS,interactive:!1,style:{float:"right",marginLeft:10}},"Running"),r.a.createElement("code",{className:"bp3-code params-list",style:{display:"block",marginTop:10}},t.param_string),r.a.createElement("div",{className:"details"},r.a.createElement("div",{className:"metrics highlight-first"},r.a.createElement("div",{className:"metric"},t.task_status.created+t.task_status.launched,r.a.createElement("label",null,"Remaining")),r.a.createElement("div",{className:"metric"},t.task_status.completed+t.task_status.accepted+t.task_status.mixed+t.task_status.rejected,r.a.createElement("label",null,"Completed")),r.a.createElement("div",{className:"metric"},t.task_status.launched+t.task_status.assigned,r.a.createElement("label",null,"In-Flight")))))}var L=a(164),w=a(24);var S=function(e){var t=e.prefix,a=e.onUpdate,n=e.field,l=t+"-"+n.dest,c=function(e){a(Object(w.a)({},l,e))};return r.a.useEffect((function(){n.default&&c(n.default)}),[n.default]),"bool"===n.type?r.a.createElement("div",{key:n.dest},r.a.createElement(i.c,{defaultChecked:n.default,label:n.dest,onChange:function(e){c(e.target.checked)}}),r.a.createElement("p",{className:"bp3-text-muted"},n.help)):r.a.createElement(i.e,{label:n.dest,labelInfo:n.help,labelFor:l},r.a.createElement(i.g,{id:l,placeholder:n.default,defaultValue:n.default,onChange:function(e){return c(e.target.value)}}))};var j=function(e){var t=e.prefix,a=e.onUpdate,n=e.options;return r.a.useEffect((function(){console.log("options changed"),a("CLEAR_"+t),Object.values(n).flatMap((function(e){return Object.values(e.args)})).forEach((function(e){var n=t+"-"+e.dest;a(Object(w.a)({},n,e.default))}))}),[n]),r.a.createElement("div",null,r.a.createElement("div",{style:{margin:"20px 0"}},Object.values(n).flatMap((function(e){return Object.values(e.args)})).map((function(e){return r.a.createElement(S,{prefix:t,onUpdate:a,field:e})}))))},A=L.a.ofType(),D=h(),T=function(e,t){var a=t.handleClick,n=t.modifiers,l=t.query;if(!n.matchesPredicate)return null;var c="".concat(e.rank,". ").concat(e.name);return r.a.createElement(i.i,{active:n.active,disabled:n.disabled,key:e.rank,onClick:a,text:G(c,l)})};function I(e){var t=e.data,a=e.onUpdate,n=r.a.useState(null),l=Object(o.a)(n,2),c=l[0],s=l[1],u=Object(E.b)({url:"blueprint/".concat((null===c||void 0===c?void 0:c.name)||"none","/options")});return r.a.createElement("div",null,r.a.createElement(A,{items:t,itemRenderer:T,onItemSelect:function(e){a({blueprint:e.name}),s(e)},activeItem:c},r.a.createElement(i.a,{icon:"map",rightIcon:"caret-down"},c?c.name:"Pick a blueprint...")),c&&r.a.createElement(D,{info:u,onLoading:function(){return r.a.createElement("span",null,"Loading...")},onError:function(){return r.a.createElement("span",null,"Error")},onData:function(e){var t=e.data;return r.a.createElement(j,{onUpdate:a,options:t.options,prefix:"bp"})}}))}function Y(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function G(e,t){var a=0,n=t.split(/\s+/).filter((function(e){return e.length>0})).map(Y);if(0===n.length)return[e];for(var l=new RegExp(n.join("|"),"gi"),c=[];;){var o=l.exec(e);if(!o)break;var i=o[0].length,s=e.slice(a,l.lastIndex-i);s.length>0&&c.push(s),a=l.lastIndex,c.push(r.a.createElement("strong",{key:a},o[0]))}var u=e.slice(a);return u.length>0&&c.push(u),c}var B=h();function U(e){var t=e.data,a=e.onUpdate,n=r.a.useState(null),l=Object(o.a)(n,2),c=l[0],s=l[1],u=Object(E.b)({url:"architect/".concat(c||"none","/options")});return r.a.createElement("div",null,t.map((function(e){return r.a.createElement(i.b,{key:e,interactive:e!==c,style:{marginBottom:10,backgroundColor:void 0},onClick:function(){s(e),a({architect:e})}},r.a.createElement(i.f,{icon:e===c?"tick-circle":"circle",color:e===c?m.a.GREEN4:m.a.GRAY4,title:"Selected",style:{marginRight:10}}),e)})),c&&r.a.createElement(B,{info:u,onLoading:function(){return r.a.createElement("span",null,"Loading...")},onError:function(){return r.a.createElement("span",null,"Error")},onData:function(e){var t=e.data;return r.a.createElement(j,{onUpdate:a,options:t.options,prefix:"arch"})}}))}var F=i.l.create({position:f.a.BOTTOM_LEFT}),q=h(),z=h(),P=function(){var e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return[{data:e,loading:arguments.length>2&&void 0!==arguments[2]&&arguments[2],error:t&&{response:{data:t}}},function(){}]}(O);return r.a.createElement(u,{badge:"Step 2",heading:r.a.createElement("span",null,"Launch it")},r.a.createElement(q,{info:e,onLoading:function(){return r.a.createElement("div",{className:"bp3-non-ideal-state bp3-skeleton"},r.a.createElement("div",{className:"bp3-non-ideal-state-visual",style:{fontSize:20}},r.a.createElement("span",{className:"bp3-icon bp3-icon-clean"})),r.a.createElement("div",null,"You have no tasks running."))},onData:function(e){var t=e.data;return r.a.createElement("div",null,t.task_runs.map((function(e){return r.a.createElement(R,{key:e.task_run_id,run:e})})))},checkIfEmptyFn:function(e){return e.task_runs},onEmptyData:function(){return r.a.createElement("div",{className:"bp3-non-ideal-state"},r.a.createElement("div",{className:"bp3-non-ideal-state-visual",style:{fontSize:20}},r.a.createElement("span",{className:"bp3-icon bp3-icon-clean"})),r.a.createElement("div",null,"You have no tasks running."))},onError:function(e){var t=e.refetch;return r.a.createElement("span",null,r.a.createElement(i.f,{icon:"warning-sign",color:m.a.RED3})," Something went wrong."," ",r.a.createElement("a",{onClick:function(){return t()}},r.a.createElement("strong",null,"Try again")))}}),r.a.createElement("div",null,r.a.createElement("div",{style:{textAlign:"center",marginTop:15}},r.a.createElement(H,null))))};function H(){var e=r.a.useState(!1),t=Object(o.a)(e,2),a=t[0],n=t[1],l=Object(E.b)({url:"launch/options"}),c=r.a.useReducer((function(e,t){var a;return a="CLEAR_ALL"===t?{}:"CLEAR_bp"===t?Object.keys(e).filter((function(e){return!e.startsWith("bp-")})).reduce((function(t,a){return t[a]=e[a],t}),{}):"CLEAR_arch"===t?Object.keys(e).filter((function(e){return!e.startsWith("arch-")})).reduce((function(t,a){return t[a]=e[a],t}),{}):Object(b.a)({},e,{},t),console.log(a),a}),{}),s=Object(o.a)(c,2),u=s[0],d=s[1];return r.a.createElement("div",null,r.a.createElement("button",{className:"bp3-button",onClick:function(){return n(!0)}},"[TODO] Launch a task"),r.a.createElement(i.d,{icon:"people",onClose:function(){return n(!1)},title:"Launch a task",autoFocus:!0,canEscapeKeyClose:!1,canOutsideClickClose:!1,enforceFocus:!0,hasBackdrop:!0,isOpen:a,position:f.a.RIGHT,size:"50%",usePortal:!0},r.a.createElement("div",{className:g.a.DRAWER_BODY,style:{backgroundColor:m.a.LIGHT_GRAY4}},r.a.createElement("div",{className:g.a.DIALOG_BODY},r.a.createElement("h2",null,"Step 1. Choose a Task Blueprint"),r.a.createElement("p",{className:"bp3-text-muted"},"A blueprint defines the task that will be run & its associated configuration parameters."),r.a.createElement(z,{info:l,onLoading:function(){return r.a.createElement("span",null,"Loading...")},onData:function(e){var t=e.data;return r.a.createElement("div",null,r.a.createElement(I,{data:t.blueprint_types,onUpdate:function(e){return d(e)}}))},onError:function(){return r.a.createElement("span",null,"Error")}}),r.a.createElement("h2",null,"Step 2. Choose an Architect"),r.a.createElement("p",{className:"bp3-text-muted"},"An architect manages the deployment target of your task."),r.a.createElement(z,{info:l,onLoading:function(){return r.a.createElement("span",null,"Loading...")},onData:function(e){var t=e.data;return r.a.createElement("div",null,r.a.createElement(U,{data:t.architect_types,onUpdate:function(e){d(e)}}))},onError:function(){return r.a.createElement("span",null,"Error")}}),r.a.createElement(i.a,{onClick:function(){var e=void 0!==u.blueprint&&void 0!==u.architect;console.log({validated:e}),e?(console.table(u),d("CLEAR_ALL"),n(!1),F.show({message:"Launching task...",icon:"cloud-upload",intent:_.a.NONE,timeout:2e3}),F.show({message:JSON.stringify(u),icon:"cloud-upload",intent:_.a.NONE,timeout:6e3}),setTimeout((function(){return F.show({message:"Launched!",icon:"cloud-upload",intent:_.a.SUCCESS,timeout:2e3})}),1e3)):F.show({message:"Error: Must selected Blueprint + Architect",icon:"cloud-upload",intent:_.a.DANGER,timeout:2e3})},large:!0,icon:"cloud-upload",intent:_.a.SUCCESS,style:{margin:"20px auto 0"}},"Launch")))))}var M=h(),W=function(){var e=Object(E.b)({url:"task_runs/reviewable"});return r.a.createElement(u,{badge:"Step 3",heading:r.a.createElement("span",null,"Review it")},r.a.createElement(M,{info:e,onLoading:function(){return r.a.createElement("div",{className:"bp3-skeleton"},r.a.createElement("div",{className:"bp3-non-ideal-state"},r.a.createElement("div",{className:"bp3-non-ideal-state-visual",style:{fontSize:20}},r.a.createElement("span",{className:"bp3-icon bp3-icon-inbox-search"})),r.a.createElement("div",null,"You have no work to review.")))},onError:function(e){var t=e.refetch;return r.a.createElement("span",null,r.a.createElement(i.f,{icon:"warning-sign",color:m.a.RED3})," Something went wrong."," ",r.a.createElement("a",{onClick:function(){return t()}},r.a.createElement("strong",null,"Try again")))},onData:function(e){var t=e.data;return r.a.createElement("span",null,JSON.stringify(t))},checkIfEmptyFn:function(e){return e.task_runs},onEmptyData:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"bp3-non-ideal-state"},r.a.createElement("div",{className:"bp3-non-ideal-state-visual",style:{fontSize:20}},r.a.createElement("span",{className:"bp3-icon bp3-icon-inbox-search"})),r.a.createElement("div",null,"You have no work to review.")))}}))},J=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"above-the-fold"}),r.a.createElement("header",null,r.a.createElement("h1",{className:"bp3-heading"},"mephisto"),r.a.createElement("em",{className:"bp3-italics bp3-text-large bp3-text-disabled",style:{position:"relative",top:-8}},"crowdsourcing without the tears")),r.a.createElement("div",{className:"container"},r.a.createElement(N,null),r.a.createElement(P,null),r.a.createElement(W,null)))},K=(a(157),a(158),a(25)),$=a.n(K).a.create({baseURL:"http://localhost:5000/api/v1/"});$.interceptors.request.use((function(e){return e.delayed?new Promise((function(t){return setTimeout((function(){return t(e)}),!0===e.delayed?600:!1===e.delayed?0:e.delayed)})):e})),Object(E.a)({axios:$});c.a.render(r.a.createElement(J,null),document.getElementById("root"))}},[[101,1,2]]]);
//# sourceMappingURL=main.afc74ed1.chunk.js.map