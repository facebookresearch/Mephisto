"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[6907],{4127:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return k}});var a=n(1987);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(n),d=o,k=c["".concat(l,".").concat(d)]||c[d]||m[d]||i;return n?a.createElement(k,r(r({ref:t},u),{},{components:n})):a.createElement(k,r({ref:t},u))}));function k(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:o,r[1]=s;for(var p=2;p<i;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4341:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return c}});var a=n(9375),o=n(8933),i=(n(1987),n(4127)),r=["components"],s={sidebar_position:1},l="Running your first task",p={unversionedId:"guides/tutorials/first_task",id:"guides/tutorials/first_task",title:"Running your first task",description:"So you want to launch your first task.",source:"@site/docs/guides/tutorials/first_task.md",sourceDirName:"guides/tutorials",slug:"/guides/tutorials/first_task",permalink:"/docs/guides/tutorials/first_task",draft:!1,editUrl:"https://github.com/facebookresearch/Mephisto/tree/main/docs/web/docs/guides/tutorials/first_task.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"guides",previous:{title:"10-minute Quickstart",permalink:"/docs/guides/quickstart"},next:{title:"Working on a custom task",permalink:"/docs/guides/tutorials/custom_react"}},u={},c=[{value:"1. Launching with default arguments",id:"1-launching-with-default-arguments",level:2},{value:"1.1 Run the task",id:"11-run-the-task",level:3},{value:"1.2 Access the task",id:"12-access-the-task",level:3},{value:"1.3 Review task results",id:"13-review-task-results",level:3},{value:"1.3.1 Run TaskReview app",id:"131-run-taskreview-app",level:3},{value:"1.3.2 Access TaskReview app",id:"132-access-taskreview-app",level:3},{value:"2. Change some defaults",id:"2-change-some-defaults",level:2},{value:"2.1 Discovering options with <code>mephisto wut</code>",id:"21-discovering-options-with-mephisto-wut",level:3},{value:"2.2 Configuring options via the command line",id:"22-configuring-options-via-the-command-line",level:3},{value:"2.3 Using yaml configurations",id:"23-using-yaml-configurations",level:3},{value:"2.4 (optional) Launch your task live",id:"24-optional-launch-your-task-live",level:3},{value:"2.4.1 Launching live on MTurk sandbox",id:"241-launching-live-on-mturk-sandbox",level:4},{value:"2.4.2 Launching live on Prolific",id:"242-launching-live-on-prolific",level:4},{value:"3. Create your own Task",id:"3-create-your-own-task",level:2}],m={toc:c};function d(e){var t=e.components,n=(0,o.Z)(e,r);return(0,i.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"running-your-first-task"},"Running your first task"),(0,i.kt)("p",null,"So you want to launch your first task.\nThankfully Mephisto makes this fairly easy!\nWe'll launch an HTML-based task as a way to get you started.\nThis guide assumes you've worked through ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/quickstart/"},"the quickstart"),", so begin there if you haven't."),(0,i.kt)("h2",{id:"1-launching-with-default-arguments"},"1. Launching with default arguments"),(0,i.kt)("p",null,"Before every task run, we recommend to remove content of folder ",(0,i.kt)("inlineCode",{parentName:"p"},"/tmp")," (in case the previous Task run didn't shut down correctly)."),(0,i.kt)("h3",{id:"11-run-the-task"},"1.1 Run the task"),(0,i.kt)("p",null,"To get started, you can launch a task by executing a run script. For instance, let's try the form-based simple task:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose -f docker/docker-compose.dev.yml run \\\n  --build \\\n  --publish 3001:3000 \\\n  --rm mephisto_dc \\\n  python /mephisto/examples/form_composer_demo/run_task.py\n")),(0,i.kt)("p",null,"or without using Docker"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"cd /mephisto/examples/form_composer_demo/\npython run_task.py\n")),(0,i.kt)("p",null,"This will launch a local HTTP server with the task hosted, based on the default configuration options:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"# examples/form_composer_demo/hydra_configs/conf/example_local_mock.yaml\ndefaults:\n  - /mephisto/blueprint: static_react_task\n  - /mephisto/architect: local\n  - /mephisto/provider: mock\n")),(0,i.kt)("p",null,"We'll dig into ",(0,i.kt)("em",{parentName:"p"},"how")," this works ",(0,i.kt)("a",{parentName:"p",href:"#33-default-abstraction-usage"},"later"),"."),(0,i.kt)("h3",{id:"12-access-the-task"},"1.2 Access the task"),(0,i.kt)("p",null,"By default, the task should be hosted at ",(0,i.kt)("a",{parentName:"p",href:"http://localhost:3000"},"http://localhost:3000")," in browser. If you used the Docker command, then the URL will be ",(0,i.kt)("a",{parentName:"p",href:"http://localhost:3001"},"http://localhost:3001"),"."),(0,i.kt)("p",null,"This default is set by the ",(0,i.kt)("inlineCode",{parentName:"p"},"LocalArchitect"),", which is used based on the ",(0,i.kt)("inlineCode",{parentName:"p"},"- /mephisto/architect: local")," line above.\nNavigating to this address should show you the preview view for the task."),(0,i.kt)("p",null,"Actually being able to access this task is done by providing ",(0,i.kt)("inlineCode",{parentName:"p"},"worker_id")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"assignment_id")," URL params, like ",(0,i.kt)("inlineCode",{parentName:"p"},"localhost:3000/?worker_id=x&assignment_id=1"),".\nThe ",(0,i.kt)("inlineCode",{parentName:"p"},"MockProvider")," interprets these to be a test worker, which you can use to try out tasks."),(0,i.kt)("p",null,"Try navigating here and completing a task by selecting a value (no need to use the file upload).\nAfter hitting submit you'll note that the window alerts you to the data that was sent to the Mephisto backend."),(0,i.kt)("p",null,"To work on another task, you'll want to change the ",(0,i.kt)("inlineCode",{parentName:"p"},"assignment_id")," in your url. This will let ",(0,i.kt)("inlineCode",{parentName:"p"},"Worker"),' "x" work on another task.\nComplete and submit this too.'),(0,i.kt)("p",null,"If you try to work on another task, you'll note that the system states you've worked on the maximum number of tasks.\nOn this task, this is because Mephisto has launched the same two tasks twice to attempt to get different workers to complete them, and as \"x\" you've already completed both tasks.\nMore on this ",(0,i.kt)("a",{parentName:"p",href:"#unit-creation-explained"},"later.")),(0,i.kt)("p",null,"If you change to another ",(0,i.kt)("inlineCode",{parentName:"p"},"worker_id"),", however, you can complete two more tasks.\nDo this and the Mephisto process should shut down cleanly."),(0,i.kt)("h3",{id:"13-review-task-results"},"1.3 Review task results"),(0,i.kt)("p",null,"By this stage, we've collected data and can now review it. For your convenience, for most cases we already wrote a browser-based application to review task results."),(0,i.kt)("p",null,"TaskReview app even can display your task unit content as it was presented to workers. ",(0,i.kt)("em",{parentName:"p"},"In your own tasks you may need to write ",(0,i.kt)("a",{parentName:"em",href:"/docs/guides/how_to_use/review_app/enabling_original_unit_preview/"},"additional react application")," to do this, but we've already done this for you in this example.")),(0,i.kt)("h3",{id:"131-run-taskreview-app"},"1.3.1 Run TaskReview app"),(0,i.kt)("p",null,"Use the following command to start TaskReview app:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose -f docker/docker-compose.dev.yml run \\\n    --build \\\n    --publish 8081:8000 \\\n    --rm mephisto_dc \\\n    mephisto review_app --host 0.0.0.0 --port 8000\n")),(0,i.kt)("p",null,"or without using Docker"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"mephisto review_app\n")),(0,i.kt)("h3",{id:"132-access-taskreview-app"},"1.3.2 Access TaskReview app"),(0,i.kt)("p",null,"You will see a message like this in your console:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"2024-03-21 16:50:55,300 - werkzeug - INFO -  * Running on http://0.0.0.0:8000/ (Press CTRL+C to quit)\n")),(0,i.kt)("p",null,"You can open the provided URL in browser ",(0,i.kt)("a",{parentName:"p",href:"http://127.0.0.1:5000"},"http://127.0.0.1:5000"),".\nIf you used the Docker command, then the URL will be ",(0,i.kt)("a",{parentName:"p",href:"http://localhost:8081"},"http://localhost:8081"),"."),(0,i.kt)("p",null,"There you will see a page showing all of your completed tasks. Clicking on a task name will let you review task units completed by each worker. Upon reviewing all task units you will be redirected back to the tasks list page, where you can download task results as one JSON file."),(0,i.kt)("p",null,"For more details, see ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/tutorials/review_app/"},"Reviewing task results"),"."),(0,i.kt)("p",null,"Congrats on finishing your first complete batch!"),(0,i.kt)("h2",{id:"2-change-some-defaults"},"2. Change some defaults"),(0,i.kt)("p",null,"Mephisto uses ",(0,i.kt)("a",{parentName:"p",href:"https://hydra.cc/"},"Hydra")," for our task configuration.\nAs such you can use any of the Hydra methods for configuration.\nOf course, to configure you have to know your options."),(0,i.kt)("h3",{id:"21-discovering-options-with-mephisto-wut"},"2.1 Discovering options with ",(0,i.kt)("inlineCode",{parentName:"h3"},"mephisto wut")),(0,i.kt)("p",null,"Mephisto configuration options can be inherited from a number of different locations, so it can be difficult to track down all available arguments on your own. We provide the ",(0,i.kt)("inlineCode",{parentName:"p"},"mephisto wut")," cli tool to make this process simpler. For instance, knowing that we're launching a ",(0,i.kt)("inlineCode",{parentName:"p"},"static_task")," with the ",(0,i.kt)("inlineCode",{parentName:"p"},"local")," architect, we can examine these for configuration options."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# show available architect options\nmephisto wut architect=local\n# show available blueprint options\nmephisto wut blueprint=static_task\n")),(0,i.kt)("p",null,"A list of all available values is available at ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/how_to_use/efficiency_organization/config_faq/"},"Common Configurations and FAQs"),"."),(0,i.kt)("p",null,"For our given example task, the values we are using for these options are available in the ",(0,i.kt)("inlineCode",{parentName:"p"},"hydra_configs/conf/example.yaml")," file. Let's try overriding some defaults."),(0,i.kt)("h3",{id:"22-configuring-options-via-the-command-line"},"2.2 Configuring options via the command line"),(0,i.kt)("p",null,"As a simple starting point, we can try launching the server on a different port. Right now the default is ",(0,i.kt)("inlineCode",{parentName:"p"},"3000"),", but with the following command we can set that ourselves:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"python run_task.py mephisto.architect.port=1234\n")),(0,i.kt)("p",null,"This should launch the same task, but now available on the port ",(0,i.kt)("inlineCode",{parentName:"p"},"1234")," rather than ",(0,i.kt)("inlineCode",{parentName:"p"},"3000"),"."),(0,i.kt)("p",null,"Once we see the task is running, we can shut down with ",(0,i.kt)("inlineCode",{parentName:"p"},"Ctrl-C"),"."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Tip:")," Shutting down Mephisto via a single ",(0,i.kt)("inlineCode",{parentName:"p"},"Ctrl-C")," interrupt ",(0,i.kt)("em",{parentName:"p"},"attempts")," to cleanup everything, but sometimes takes time for cleanup steps.\nYou can skip some steps with additional ",(0,i.kt)("inlineCode",{parentName:"p"},"Ctrl-C")," presses, but then you'll need to clean up resources yourself.")),(0,i.kt)("h3",{id:"23-using-yaml-configurations"},"2.3 Using yaml configurations"),(0,i.kt)("p",null,"While it makes sense to update some parameters on the command line while iterating, generally it's easier to extend the ",(0,i.kt)("inlineCode",{parentName:"p"},"conf")," files directly, then apply all of the options by overriding ",(0,i.kt)("inlineCode",{parentName:"p"},"conf"),".\nTry copying the ",(0,i.kt)("inlineCode",{parentName:"p"},"examples/form_composer_demo/hydra_configs/conf/example_local_mock.yaml")," file into ",(0,i.kt)("inlineCode",{parentName:"p"},"examples/form_composer_demo/hydra_configs/conf/my_config.yaml"),".\nAlso file ",(0,i.kt)("inlineCode",{parentName:"p"},"examples/form_composer_demo/data/simple/task_data.json")," into ",(0,i.kt)("inlineCode",{parentName:"p"},"examples/form_composer_demo/data/simple/my_task_data.json")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'#examples/form_composer_demo/hydra_configs/conf/my_config.yaml\n\n#@package _global_\ndefaults:\n  - /mephisto/blueprint: static_react_task\n  - /mephisto/architect: local\n  - /mephisto/provider: mock\n\nmephisto:\n  blueprint:\n    data_json: ${task_dir}/data/simple/my_task_data.json  # Change path to your new file and change some data in it\n    task_source: ${task_dir}/webapp/build/bundle.js\n    task_source_review: ${task_dir}/webapp/build/bundle.review.js\n    link_task_source: false\n    extra_source_dir: ${task_dir}/webapp/src/static\n    units_per_assignment: 3\n  task:\n    task_name: "My first own task"  # Change the task name\n    task_title: "New title"  # Change the task title\n    task_description: "In this Task, we use FormComposer feature."  # Change the task description\n    task_reward: 0\n    task_tags: "test,simple,form"\n    force_rebuild: true\n')),(0,i.kt)("p",null,"Save this configuration file, and you're ready to launch again:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose -f docker/docker-compose.dev.yml run \\\n  --build \\\n  --publish 3001:3000 \\\n  --rm mephisto_dc \\\n  python /mephisto/examples/form_composer_demo/run_task.py conf=my_config\n")),(0,i.kt)("p",null,"or without using Docker"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cd /mephisto/examples/form_composer_demo/\npython run_task.py conf=my_config\n")),(0,i.kt)("p",null,"Now you'll notice that Mephisto launches your task under the new task name:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"[...][...][INFO] - Creating a task run under task name: My first own task\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"A note on ",(0,i.kt)("inlineCode",{parentName:"strong"},"task_name"),"s:"),"\nThe ",(0,i.kt)("inlineCode",{parentName:"p"},"task_name")," parameter is particularly important for setting up workflows. Many of Mephisto's features are shared under a specific ",(0,i.kt)("inlineCode",{parentName:"p"},"task_name")," namespace, including review flows and unit completion maximums per worker per namespace. Later ",(0,i.kt)("a",{parentName:"p",href:"../workflows"},"guides")," go more in-depth on best practices.")),(0,i.kt)("p",null,"Navigating to a task (",(0,i.kt)("inlineCode",{parentName:"p"},"localhost:3000/?worker_id=x&assignment_id=1")," or woth Docker on ",(0,i.kt)("inlineCode",{parentName:"p"},"3001")," port) should now show you a task loaded from a different data file.\nCompleting this task will lead Mephisto to shut down cleanly."),(0,i.kt)("p",null,"You can now review this task with the review script again, this time providing the task name ",(0,i.kt)("inlineCode",{parentName:"p"},"My first own task"),"."),(0,i.kt)("h3",{id:"24-optional-launch-your-task-live"},"2.4 (optional) Launch your task live"),(0,i.kt)("p",null,"So far we've been launching our task in a testing mode (with ",(0,i.kt)("inlineCode",{parentName:"p"},"local")," architect and ",(0,i.kt)("inlineCode",{parentName:"p"},"mock")," provider)."),(0,i.kt)("p",null,"To make your Task page accessible to the others (e.g. external workers), you will either need to obtain a publicly accessible static IP address for you machine, or launch the task with a non-",(0,i.kt)("inlineCode",{parentName:"p"},"mock")," human cloud platform and a non-",(0,i.kt)("inlineCode",{parentName:"p"},"local")," architect."),(0,i.kt)("p",null,"In the below examples we consider an EC2 architect and a few common providers. This configuration is different from the testing mode:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"EC2 architect will build a temporary EC2 server in the cloud, which will:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"serve webpages with newly assigned units of your (now publicly accessible) Task to workers on human cloud provider's platform"),(0,i.kt)("li",{parentName:"ul"},"send completed task results to your machine"),(0,i.kt)("li",{parentName:"ul"},"dismantle the EC2 server if the Task is terminated for whichever reason"))),(0,i.kt)("li",{parentName:"ul"},"non-mock provider will maintain an API connection with a human cloud platform to:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"direct workers willing to work on your Task to an EC2 webpage for their newly assigned task unit"),(0,i.kt)("li",{parentName:"ul"},"monitor status of all task units currently being worked on"),(0,i.kt)("li",{parentName:"ul"},"handle routine opeartions on task units and workers (expire a stalled unit; give bonus to worker; etc)")))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Note: The Mephisto process must remain continuously running when in-use, so you must leave your machine running to be able to access a task.")),(0,i.kt)("h4",{id:"241-launching-live-on-mturk-sandbox"},"2.4.1 Launching live on MTurk sandbox"),(0,i.kt)("p",null,"First, let's specify the API credentials:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create file ",(0,i.kt)("inlineCode",{parentName:"li"},"docker/aws_credentials")," and populate it with your AWS keys info (for EC2 architect)"),(0,i.kt)("li",{parentName:"ul"},"Add your Mturk account API keys to ",(0,i.kt)("inlineCode",{parentName:"li"},"docker/aws_credentials")," file"),(0,i.kt)("li",{parentName:"ul"},"Clone file ",(0,i.kt)("inlineCode",{parentName:"li"},"docker/docker-compose.dev.yml")," as ",(0,i.kt)("inlineCode",{parentName:"li"},"docker/docker-compose.local.yml"),", and point its ",(0,i.kt)("inlineCode",{parentName:"li"},"env_file")," to ",(0,i.kt)("inlineCode",{parentName:"li"},"envs/env.local")),(0,i.kt)("li",{parentName:"ul"},"Ensure ",(0,i.kt)("inlineCode",{parentName:"li"},"envs/env.local")," file has a defeinition of these env variables:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"CYPRESS_CACHE_FOLDER"),": set it to any writable folder, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"/tmp"))))),(0,i.kt)("p",null,"Now we're ready to launch an example task on Mturk platform:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose -f docker/docker-compose.local.yml run \\\n  --build \\\n  --publish 3001:3000 \\\n  --rm mephisto_dc \\\n  python /mephisto/examples/form_composer_demo/run_task_dynamic_ec2_mturk_sandbox.py\n")),(0,i.kt)("p",null,"Note that this command reads task parameters from task config file referenced within the ",(0,i.kt)("inlineCode",{parentName:"p"},"run_task_dynamic_ec2_mturk_sandbox.py")," script."),(0,i.kt)("p",null,"Generally, you would want to adjust task config file to your needs.\nYou don't need to do this step ",(0,i.kt)("em",{parentName:"p"},"right now"),", however it's important for understanding how to take one of these tasks live.\nAssuming you've completed the optional steps in ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/quickstart/#optional-set-up-mturk"},"the quickstart"),",\nyou can make the following changes to your config file, replacing ",(0,i.kt)("inlineCode",{parentName:"p"},"my_mturk_user_sandbox")," with the id you used in it's place when registering initially:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'#examples/form_composer_demo/hydra_configs/conf/my_config.yaml\n\n#@package _global_\ndefaults:\n  - /mephisto/blueprint: static_react_task\n  - /mephisto/architect: ec2  # To launch live, we\'ll need an external server\n  - /mephisto/provider: mturk_sandbox  # And an external provider\n\nmephisto:\n  architect:\n    _architect_type: ec2\n    profile_name: my_ec2_user  # Name of EC2 user\n    subdomain: "0123"  # Each Task Run must have a unique subdomain\n  blueprint:\n    data_json: ${task_dir}/data/dynamic/task_data.json\n    task_source: ${task_dir}/webapp/build/bundle.js\n    task_source_review: ${task_dir}/webapp/build/bundle.review.js\n    preview_source: ${task_dir}/preview/mturk_preview.html\n    link_task_source: false\n    extra_source_dir: ${task_dir}/webapp/src/static\n    units_per_assignment: 1\n  log_level: "debug"\n  task:\n    task_name: "Sample Questionnaire"\n    task_title: "Dynamic form-based Tasks for Mturk"\n    task_description: "In this Task, we use dynamic FormComposer feature."\n    task_reward: 0.05\n    task_tags: "dynamic,form,testing"\n    assignment_duration_in_seconds: 3600\n    force_rebuild: true\n    max_num_concurrent_units: 1\n    maximum_units_per_worker: 2\n  provider:\n    requester_name: my_mturk_user_sandbox  # Or whatever ID you provided with `mephisto register mturk_sandbox`\n')),(0,i.kt)("p",null,"Save this configuration file as ",(0,i.kt)("inlineCode",{parentName:"p"},"examples/form_composer_demo/hydra_configs/conf/my_config.yaml"),", and you will see your task go live on Mturk platform!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose -f docker/docker-compose.dev.yml run \\\n  --build \\\n  --publish 3001:3000 \\\n  --rm mephisto_dc \\\n  python /mephisto/examples/form_composer_demo/run_task_dynamic_ec2_mturk_sandbox.py conf=my_config\n")),(0,i.kt)("p",null,"or without using Docker"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cd /mephisto/examples/form_composer_demo/\npython run_task_dynamic_ec2_mturk_sandbox.py conf=my_config\n")),(0,i.kt)("p",null,"Mephisto should print out links to view your task on the mturk sandbox,\nlike ",(0,i.kt)("inlineCode",{parentName:"p"},"https://workersandbox.mturk.com/mturk/preview?groupId=XXXXXXXXXXXXXXXX"),".\nNavigate here and you'll be see your task live on Mturk sandbox, as if you were a worker!"),(0,i.kt)("p",null,"Complete this task, and you can review it in the same way as usual."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Tip"),": You can reuse common configurations by ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/how_to_use/efficiency_organization/reusing_configs/"},"associating them with a profile"),".\nUsually these contain ",(0,i.kt)("inlineCode",{parentName:"p"},"Provider")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Architect")," arguments, as these usually aren't related to a specific task.")),(0,i.kt)("h4",{id:"242-launching-live-on-prolific"},"2.4.2 Launching live on Prolific"),(0,i.kt)("p",null,"First, let's specify the API credentials:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create file ",(0,i.kt)("inlineCode",{parentName:"li"},"docker/aws_credentials")," and populate it with your AWS keys info (for EC2 architect)"),(0,i.kt)("li",{parentName:"ul"},"Clone file ",(0,i.kt)("inlineCode",{parentName:"li"},"docker/docker-compose.dev.yml")," as ",(0,i.kt)("inlineCode",{parentName:"li"},"docker/docker-compose.local.yml"),", and point its ",(0,i.kt)("inlineCode",{parentName:"li"},"env_file")," to ",(0,i.kt)("inlineCode",{parentName:"li"},"envs/env.local")),(0,i.kt)("li",{parentName:"ul"},"Ensure ",(0,i.kt)("inlineCode",{parentName:"li"},"envs/env.local")," file has a defeinition of these env variables:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"PROLIFIC_API_KEY"),": set it to your Prolific API key"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"CYPRESS_CACHE_FOLDER"),": set it to any writable folder, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"/tmp"))))),(0,i.kt)("p",null,"Now we're ready to launch an example task on Prolific platform:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose -f docker/docker-compose.local.yml run \\\n  --build \\\n  --publish 3001:3000 \\\n  --rm mephisto_dc \\\n  python /mephisto/examples/form_composer_demo/run_task_dynamic_ec2_prolific.py\n")),(0,i.kt)("p",null,"The other steps are similar to launching on MTurk, just task config file is a bit different."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'#examples/form_composer_demo/hydra_configs/conf/my_config.yaml\n\n#@package _global_\ndefaults:\n  - /mephisto/blueprint: static_react_task\n  - /mephisto/architect: ec2  # To launch live, we\'ll need an external server\n  - /mephisto/provider: prolific  # And an external provider\n\nmephisto:\n  architect:\n    _architect_type: ec2\n    profile_name: my_ec2_user  # Name of EC2 user\n    subdomain: "0123"  # Each Task Run must have a new subdomain\n  blueprint:\n    data_json: ${task_dir}/data/dynamic/task_data.json\n    task_source: ${task_dir}/webapp/build/bundle.js\n    task_source_review: ${task_dir}/webapp/build/bundle.review.js\n    link_task_source: false\n    extra_source_dir: ${task_dir}/webapp/src/static\n    units_per_assignment: 1\n  log_level: "debug"\n  task:\n    task_name: "Sample Questionnaire"\n    # Note: don\'t use `Prolific` in task names, because Prolific will (silently) block your account\n    task_title: "Dynamic form-based Tasks for Prolifik"\n    task_description: "In this Task, we use dynamic FormComposer feature."\n    task_reward: 70\n    task_tags: "test,simple,form"\n    force_rebuild: true\n    max_num_concurrent_units: 1\n  provider:\n    # Prolific researcher has Workspaces to group Projects\n    prolific_workspace_name: "My Workspace"\n    # Prolific researcher has Projects to group Studies\n    prolific_project_name: "Project"\n    # Temporary Prolific Participant Group where we save known workers\n    # who satisfy Mephisto qualifications required in this Task\n    prolific_allow_list_group_name: "Allow list"\n    # Temporary Prolific Participant Group where we save known workers\n    # that we have banned during previous task reviews\n    prolific_block_list_group_name: "Block list"\n    # We can additionally use worker filtering criteria that Prolific platform supprts\n    prolific_eligibility_requirements:\n      - name: "CustomWhitelistEligibilityRequirement"\n        # This limits your Task only to Prolific Participants (workers) with these IDs\n        white_list:\n          - 6528ff4ac201b9605db841e4\n          - 6528ff6b4a6e8ccb70226c4b\n          - 6528ff850867369791a99491\n          - 6528ffa32c90c600f42b3589\n          - 6528ffc2618c084ccb2b37a0\n          - 6528ffe199313384fde5028e\n          - 652907b023fbe4ed22234d75\n          - 652907fb98474afcbe5cb5cd\n        # This limits your Task only to Prolific Participants (workers) in this age range\n      - name: "ApprovalRateEligibilityRequirement"\n        minimum_approval_rate: 1\n        maximum_approval_rate: 100\n')),(0,i.kt)("p",null,"For more details, see ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/how_to_use/providers/prolific/intro/"},"Prolific overview"),"."),(0,i.kt)("h2",{id:"3-create-your-own-task"},"3. Create your own Task"),(0,i.kt)("p",null,"In the introductory examples we user pre-created Tasks. To design your own custom Tasks, you have two options:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Code your own Task application (build components like React-based UI, custom Agent state, etc). This works best for highly customized Task logic.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Examples of custom Tasks include ",(0,i.kt)("inlineCode",{parentName:"li"},"examples/remote_procedure")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"examples/parlai_chat_task_demo")))),(0,i.kt)("li",{parentName:"ul"},"Use an existing Task generator (and specify your task via configs with little, if any, custom coding required). This works best for fairly standard Task logic.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"form-based Tasks: see ",(0,i.kt)("a",{parentName:"li",href:"/docs/guides/how_to_use/form_composer/running/"},"Run FormComposer tasks"))))))}d.isMDXComponent=!0}}]);