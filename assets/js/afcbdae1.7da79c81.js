"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[3916],{4127:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return k}});var o=n(1987);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),d=r,k=u["".concat(s,".").concat(d)]||u[d]||m[d]||i;return n?o.createElement(k,a(a({ref:t},p),{},{components:n})):o.createElement(k,a({ref:t},p))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,a=new Array(i);a[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:r,a[1]=l;for(var c=2;c<i;c++)a[c]=n[c];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3739:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return s},default:function(){return d},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return u}});var o=n(9375),r=n(8933),i=(n(1987),n(4127)),a=["components"],l={sidebar_position:3},s="Running Mephisto with Docker",c={unversionedId:"guides/how_to_use/efficiency_organization/docker",id:"guides/how_to_use/efficiency_organization/docker",title:"Running Mephisto with Docker",description:"You may want to keep Mephisto environment entirely contained, and set it up with just a few commands. To do this, we support Docker and Docker Compose as a launch option.",source:"@site/docs/guides/how_to_use/efficiency_organization/docker.md",sourceDirName:"guides/how_to_use/efficiency_organization",slug:"/guides/how_to_use/efficiency_organization/docker",permalink:"/docs/guides/how_to_use/efficiency_organization/docker",draft:!1,editUrl:"https://github.com/facebookresearch/Mephisto/tree/main/docs/web/docs/guides/how_to_use/efficiency_organization/docker.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"guides",previous:{title:"View task health and status with Mephisto Metrics",permalink:"/docs/guides/how_to_use/efficiency_organization/metrics_dashboard"},next:{title:"Manual installation Mephisto",permalink:"/docs/guides/how_to_use/efficiency_organization/manual_installation"}},p={},u=[{value:"Installation",id:"installation",level:2},{value:"Running form-based task example",id:"running-form-based-task-example",level:2},{value:"Customizing Docker settings",id:"customizing-docker-settings",level:2}],m={toc:u};function d(e){var t=e.components,n=(0,r.Z)(e,a);return(0,i.kt)("wrapper",(0,o.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"running-mephisto-with-docker"},"Running Mephisto with Docker"),(0,i.kt)("p",null,"You may want to keep Mephisto environment entirely contained, and set it up with just a few commands. To do this, we support Docker and Docker Compose as a launch option."),(0,i.kt)("h2",{id:"installation"},"Installation"),(0,i.kt)("p",null,"Install Docker and Docker Compose using the ",(0,i.kt)("a",{parentName:"p",href:"https://docs.docker.com/get-docker/"},"official guide"),". You can learn about Docker Compose commands on its ",(0,i.kt)("a",{parentName:"p",href:"https://docs.docker.com/compose/"},"documentation page"),"."),(0,i.kt)("h2",{id:"running-form-based-task-example"},"Running form-based task example"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose -f docker/docker-compose.dev.yml run \\\n  --build \\\n  --publish 3001:3000 \\\n  --rm mephisto_dc \\\n  python /mephisto/examples/form_composer_demo/run_task.py\n")),(0,i.kt)("h2",{id:"customizing-docker-settings"},"Customizing Docker settings"),(0,i.kt)("p",null,"All docker settings you can find in ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/facebookresearch/Mephisto/tree/main/docker"},(0,i.kt)("inlineCode",{parentName:"a"},"docker")," directory"),"."),(0,i.kt)("p",null,"Files and directories:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"docker-compose.dev.yml")," - minimal development Docker Compose config to start all our examples and apps"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"docker-compose.dev.vscode.yml")," - same as previous, but set up with Python-debugger for VS Code as it requires extra settings"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"aws_credentials.example")," - example of the structure of file ",(0,i.kt)("inlineCode",{parentName:"li"},"aws_credentials"),"; this file is mounted into ",(0,i.kt)("inlineCode",{parentName:"li"},"~/.aws/credentials")," file inside dockerized environment"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"entrypoints")," - directory with entrypoint scripts (used to run commands at launching of a Docker container)",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"server.mturk.sh")," - example for MTurk"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"server.prolific.sh")," - example for Prolific"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"envs")," - directory with environmental variales for the dockerized environment",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"env.dev")," - lists env variables you may need for Mephisto (populate these empty values according to your needs)")))),(0,i.kt)("p",null,"If you want to customize Docker configs (e.g. use your AWS credentials), we recommend you to create these files, and save your customizations in them:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"server.local.sh")," in entrypoints"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"env.local")," in ",(0,i.kt)("inlineCode",{parentName:"li"},"envs")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"docker-compose.local.yml")," config next to the standard ",(0,i.kt)("inlineCode",{parentName:"li"},"docker-compose.dev.yml")," (and point it to ",(0,i.kt)("inlineCode",{parentName:"li"},"server.local.sh")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"env.local")," files)")),(0,i.kt)("p",null,"Now you can enable your Docker customizations simply by specifying ",(0,i.kt)("inlineCode",{parentName:"p"},"-f docker/docker-compose.local.yml")," parameter in all Docker Compose commands. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose -f docker/docker-compose.local.yml run \\\n  --build \\\n  --publish 3001:3000 \\\n  --rm mephisto_dc \\\n  python /mephisto/examples/form_composer_demo/run_task.py\n")))}d.isMDXComponent=!0}}]);